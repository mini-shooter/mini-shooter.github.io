<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8" />
<title>Mini Shooter — Free For All (Web) | mini-shooter.github.io</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<style>
  :root{--bg:#0b0f1a;--txt:#eaf2ff;--glass:rgba(255,255,255,.08);--b:rgba(255,255,255,.18);
        --blue:#79a8ff;--cyan:#5bd1d7;--red:#f25f5c;--green:#7bf1a8}
  *{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
  html,body{margin:0;height:100%;background:#0c1022;color:var(--txt);
            font-family:system-ui,Segoe UI,Roboto,Arial;overflow:hidden;touch-action:none}
  #game{position:fixed;inset:0;width:100vw;height:100vh;background:var(--bg);display:block;touch-action:none;user-select:none}
  #hud{position:fixed;top:10px;left:10px;z-index:10;display:flex;gap:10px;align-items:center;background:var(--glass);border:1px solid var(--b);border-radius:14px;padding:8px 10px;backdrop-filter:blur(8px)}
  .title{font-weight:800;letter-spacing:1px;font-size:14px}
  .title a{color:inherit;text-decoration:none;}
  .title a:hover{text-decoration:underline;text-underline-offset:3px;}
  .hp{display:flex;align-items:center;gap:8px;padding:6px 10px;border-radius:12px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.18)}
  .hpbar{width:140px;height:10px;border-radius:999px;background:rgba(255,255,255,.08);overflow:hidden;border:1px solid rgba(255,255,255,.18)}
  .hpfill{width:100%;height:100%;background:linear-gradient(90deg,#38f1e7,#79a8ff);box-shadow:0 0 12px rgba(121,168,255,.5);transition:width .18s}
  .badge{display:flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;font-weight:700;background:var(--glass);border:1px solid var(--b)}
  #overlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.55);z-index:20;cursor:pointer;touch-action:none}
  #overlay .box{padding:28px 40px;border-radius:20px;text-align:center;background:rgba(15,20,40,.9);border:2px solid rgba(121,168,255,.4);box-shadow:0 0 25px rgba(121,168,255,.5), inset 0 0 12px rgba(91,209,215,.4);animation:pulse 2s infinite}
  #overlay h1{margin:0;font-size:32px;color:#fff;text-shadow:0 0 12px var(--blue)}
  #overlay p{margin-top:8px;font-size:14px;opacity:.85}
  @keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.04)}100%{transform:scale(1)}}
  #rotate{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.75);z-index:30;text-align:center;padding:20px}
  #rotate .rbox{background:rgba(15,20,40,.9);border:2px solid rgba(121,168,255,.4);border-radius:16px;padding:18px 22px}
  #rotate h2{margin:0 0 6px 0;font-size:22px}
  #rotate p{margin:0;opacity:.85}
  #hint{position:fixed;bottom:10px;left:50%;transform:translateX(-50%);z-index:9;background:var(--glass);border:1px solid var(--b);padding:6px 10px;border-radius:10px;backdrop-filter:blur(8px);font-size:13px;text-align:center}
  #joy{position:fixed;left:0;top:0;pointer-events:none;z-index:6}
</style>
</head>
<body>
<canvas id="game"></canvas>

<div id="hud">
  <div class="title">
    <a href="https://mini-shooter.github.io" target="_blank" rel="noopener">
      MINI SHOOTER — FREE FOR ALL (Web)
    </a>
  </div>
  <div class="hp">
    <span style="opacity:.85;font-weight:700;">HP</span>
    <div class="hpbar"><div class="hpfill" id="hpfill"></div></div>
    <span id="hptext" style="min-width:26px;text-align:right;font-weight:800;">3</span>
  </div>
  <div class="badge">SCORE <span id="score" style="font-weight:800;margin-left:6px">0</span></div>
</div>

<div id="overlay">
  <div class="box">
    <h1 id="startTitle">CLICK / TAP TO START</h1>
    <p id="startSub">Desktop: Maus • Mobile: Joysticks</p>
  </div>
</div>

<div id="rotate">
  <div class="rbox">
    <h2>Bitte ins Querformat drehen</h2>
    <p>Für Touch-Steuerung ist Landscape am besten.</p>
  </div>
</div>

<div id="hint">
  Desktop: Klicke zum Starten • WASD + Maus<br>
  Mobile: Links bewegen • Rechts ziehen = zielen, loslassen = Schuss • Rechts tippen = Auto-Aim
</div>

<canvas id="joy" width="1" height="1"></canvas>

<script>
(()=>{
  document.title="Mini Shooter — Free For All (Web) | mini-shooter.github.io";
  const isMobile=/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)||(navigator.maxTouchPoints||0)>0;
  const canvas=document.getElementById('game'),ctx=canvas.getContext('2d');
  const joyCanvas=document.getElementById('joy'),jctx=joyCanvas.getContext('2d');
  const overlay=document.getElementById('overlay'),rotate=document.getElementById('rotate');
  const hpfill=document.getElementById('hpfill'),hptext=document.getElementById('hptext'),scoreEl=document.getElementById('score');

  function resize(){const dpr=Math.min(2,window.devicePixelRatio||1);
    canvas.width=Math.floor(innerWidth*dpr);canvas.height=Math.floor(innerHeight*dpr);
    ctx.setTransform(dpr,0,0,dpr,0,0);joyCanvas.width=innerWidth;joyCanvas.height=innerHeight;}
  addEventListener('resize',resize,{passive:true});resize();

  function updateRotate(){rotate.style.display=(isMobile&&innerHeight>innerWidth)?'flex':'none';}
  addEventListener('resize',updateRotate);updateRotate();

  function startFromOverlay(e){e.preventDefault();overlay.style.display='none';startGame();}
  overlay.addEventListener('touchstart',startFromOverlay,{passive:false});
  overlay.addEventListener('click',startFromOverlay);

  let S=null;const clamp=(v,a,b)=>Math.max(a,Math.min(b,v));
  const ang=(x1,y1,x2,y2)=>Math.atan2(y2-y1,x2-x1);
  const d2=(x1,y1,x2,y2)=>{const dx=x2-x1,dy=y2-y1;return dx*dx+dy*dy};

  function resetGame(){S={run:true,score:0,px:innerWidth/2,py:innerHeight/2,pr:12,speed:isMobile?300:260,hp:3,hpMax:3,
    keys:{},mouse:{x:innerWidth/2,y:innerHeight/2},bullets:[],enemies:[],heals:[],spawnT:0,shootCooldown:0,healT:3,aimR:50,faceA:0};updHP();updScore();}
  function updHP(){hptext.textContent=S.hp;hpfill.style.width=(S.hp/S.hpMax*100)+'%';}
  function updScore(){scoreEl.textContent=S.score;}

  // === Shooting mit AimAssist + Bullet-Magnet ===
  function fireShot(angle){
    if(S.shootCooldown>0)return;
    let best=null,bestD2=S.aimR*S.aimR;
    for(const e of S.enemies){const dd=d2(S.px,S.py,e.x,e.y);if(dd<bestD2){bestD2=dd;best=e;}}
    if(best) angle=ang(S.px,S.py,best.x,best.y);
    const spd=520;
    S.bullets.push({x:S.px+Math.cos(angle)*S.pr,y:S.py+Math.sin(angle)*S.pr,
      vx:Math.cos(angle)*spd,vy:Math.sin(angle)*spd,life:.9,corrected:false});
    S.shootCooldown=.12;S.faceA=angle;
  }

  // === Spawns ===
  function spawnEnemy(){const side=(Math.random()*4)|0;let x=0,y=0,m=24;
    if(side===0){x=Math.random()*innerWidth;y=-m;}
    if(side===1){x=innerWidth+m;y=Math.random()*innerHeight;}
    if(side===2){x=Math.random()*innerWidth;y=innerHeight+m;}
    if(side===3){x=-m;y=Math.random()*innerHeight;}
    const speed=80+Math.random()*80+Math.min(160,S.score*.7),r=12+Math.random()*8;
    S.enemies.push({x,y,r,speed});}
  function spawnHeal(){const margin=40,x=margin+Math.random()*(innerWidth-margin*2),
    y=margin+Math.random()*(innerHeight-margin*2);S.heals.push({x,y,r:14,life:9+Math.random()*6,age:0});}

  // === Start Loop ===
  function startGame(){resetGame();let last=performance.now();
    function loop(now){if(!S.run)return;const dt=Math.min(.033,(now-last)/1000);last=now;S.shootCooldown=Math.max(0,S.shootCooldown-dt);

      // Bewegung nur Keys (vereinfachte Version für Demo)
      let vx=0,vy=0;if(S.keys['KeyW'])vy-=1;if(S.keys['KeyS'])vy+=1;if(S.keys['KeyA'])vx-=1;if(S.keys['KeyD'])vx+=1;
      if(vx||vy){const L=Math.hypot(vx,vy);vx/=L;vy/=L;}
      S.px=clamp(S.px+vx*S.speed*dt,S.pr,innerWidth-S.pr);
      S.py=clamp(S.py+vy*S.speed*dt,S.pr,innerHeight-S.pr);

      // Auto-Aim mit Maus halten
      if(!isMobile&&S.keys['Space'])fireShot(ang(S.px,S.py,S.mouse.x,S.mouse.y));

      // Bullets + Magnet
      for(let i=S.bullets.length-1;i>=0;i--){const b=S.bullets[i];
        b.x+=b.vx*dt;b.y+=b.vy*dt;b.life-=dt;
        for(const e of S.enemies){
          const dist=Math.sqrt(d2(b.x,b.y,e.x,e.y));
          if(dist<25&&!b.corrected){
            const a=ang(b.x,b.y,e.x,e.y),spd=520;b.vx=Math.cos(a)*spd;b.vy=Math.sin(a)*spd;b.corrected=true;
            ctx.strokeStyle="#fff";ctx.lineWidth=1.5;ctx.beginPath();
            ctx.moveTo(b.x-4,b.y);ctx.lineTo(b.x+4,b.y);
            ctx.moveTo(b.x,b.y-4);ctx.lineTo(b.x,b.y+4);ctx.stroke();
          }
        }
        if(b.life<=0)S.bullets.splice(i,1);
      }

      // Gegner
      for(let i=S.enemies.length-1;i>=0;i--){const e=S.enemies[i],a=ang(e.x,e.y,S.px,S.py);
        e.x+=Math.cos(a)*e.speed*dt;e.y+=Math.sin(a)*e.speed*dt;}

      // Render
      ctx.clearRect(0,0,innerWidth,innerHeight);
      ctx.fillStyle="#79a8ff";for(const b of S.bullets){ctx.beginPath();ctx.arc(b.x,b.y,3,0,Math.PI*2);ctx.fill();}
      ctx.fillStyle="#f25f5c";for(const e of S.enemies){ctx.beginPath();ctx.arc(e.x,e.y,e.r,0,Math.PI*2);ctx.fill();}
      ctx.fillStyle="#79a8ff";ctx.beginPath();ctx.arc(S.px,S.py,S.pr,0,Math.PI*2);ctx.fill();
      requestAnimationFrame(loop);}
    requestAnimationFrame(loop);}
})();
</script>
</body>
</html>
